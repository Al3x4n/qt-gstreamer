project(QtGstreamer)
cmake_minimum_required(VERSION 2.6)
enable_testing()

set(CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/cmake/modules)
set(QT_DONT_USE_QTGUI 1)
set(QT_USE_QTTEST 1)

find_package(Qt4 REQUIRED)
find_package(Automoc4 REQUIRED)
find_package(Boost REQUIRED)
find_package(GStreamer REQUIRED)
find_package(GLIB2 REQUIRED)
find_package(GObject REQUIRED)
find_package(LibXml2 REQUIRED)
find_package(FLEX REQUIRED)
find_package(BISON REQUIRED)

include(${QT_USE_FILE})
include_directories(${GSTREAMER_INCLUDE_DIR} ${GLIB2_INCLUDE_DIR}
                    ${LIBXML2_INCLUDE_DIR} ${Boost_INCLUDE_DIRS})

if (CMAKE_COMPILER_IS_GNUCXX)
    include(TestCXXAcceptsFlag)
    check_cxx_accepts_flag("-std=c++0x" HAVE_CXX0X_SUPPORT)
    if (HAVE_CXX0X_SUPPORT)
        set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++0x")
    endif()
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra -Wformat-security -Wundef -Wpointer-arith -Wcast-align -fno-common")
endif ()

add_subdirectory(codegen)
add_subdirectory(src)
add_subdirectory(tests)
add_subdirectory(examples)
